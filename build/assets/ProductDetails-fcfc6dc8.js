import{f as Q,r as o,A as Y,B as q,j as e,c as z,k as B,C as J,D as U,E as X,_ as C,u as G,H as K,p as W,N as ee,I as se,o as D,J as te,d as re,y as le}from"./index-0f62f80c.js";import{S as _}from"./StarsRatings-7487ea78.js";import{o as ae}from"./features-89b8e0b8.js";import{R as M}from"./ReviewForm-c31b400b.js";const oe=({productId:c,numOfReviews:m})=>{const{user:r}=Q(s=>s.userReducer),[i,h]=o.useState(4),[f,x]=o.useState(!1),{data:n,isLoading:g,error:p}=Y(c),a=Array.isArray(n==null?void 0:n.reviews)?n==null?void 0:n.reviews:[],[j,{isLoading:u}]=q();o.useEffect(()=>{if(a){const s=a.find(d=>d.userId===(r==null?void 0:r._id));x(!!s)}},[a,r]);const b=async()=>{try{const s=await j({userId:r._id,productId:c});C.error("bhag yahan se"),ae(s)}catch(s){console.error("Error deleting review:",s)}};return p?e.jsx("p",{children:"Error Fetching review"}):e.jsxs("div",{className:"container mx-auto p-4",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("h2",{className:"text-2xl font-semibold mb-4",children:["Product Reviews (",m,")"]}),e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"No one will be able to submit reviews here in Production Enviroment but can edit here this is for demo"})]}),e.jsx(M,{productId:c,user:r}),e.jsx("div",{className:"md:mx-12 mt-12 max-sm:border-2 ",children:g?e.jsx("div",{className:"flex items-center justify-center h-[15.4rem]",children:e.jsx(z,{className:"animate-spin h-24 w-24 text-gray-500"})}):a.length>0?e.jsxs(e.Fragment,{children:[e.jsx("ul",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a.slice(0,i).map((s,d)=>e.jsxs("li",{className:"border pb-4 mb-4 py-3 px-2",children:[e.jsxs("div",{className:"flex flex-row justify-between items-center",children:[e.jsxs("div",{className:"flex flex-row items-center gap-3",children:[e.jsx("span",{children:e.jsx("img",{src:s.photo,alt:"customer",className:"rounded-full h-8 w-8"})}),e.jsx("p",{children:e.jsx("strong",{children:s.name})}),e.jsx("span",{className:"text-md",children:e.jsx(_,{rating:s.rating})})]}),s.userId===(r==null?void 0:r._id)&&e.jsxs("div",{className:"flex flex-row items-center",children:[e.jsx("button",{onClick:b,className:"px-1 text-[0.7rem] sm:text-sm py-1 rounded-md",children:u?e.jsx(z,{className:"animate-spin"}):e.jsx(B,{})}),e.jsx(M,{isEditing:f,oldComment:s.comment,oldRating:s.rating,productId:c,user:r})]})]}),e.jsxs("div",{className:"flex mr-2 mt-3 flex-row justify-between",children:[e.jsx("p",{children:s.comment}),e.jsx("p",{className:"font-bold flex justify-end text-sm w-36",children:J(s.date)})]})]},d))}),a.length>4&&e.jsx("div",{className:"flex justify-center",children:a.length>i?e.jsxs("button",{type:"button",className:"flex items-center gap-1 border border-gray-300 px-3 py-1 rounded-md hover:bg-gray-200",onClick:()=>h(s=>s+4),children:[e.jsx(U,{}),e.jsx("span",{children:"Show More"})]}):e.jsxs("button",{type:"button",className:"flex items-center gap-1 border border-gray-300 px-3 py-1 rounded-md hover:bg-gray-200",onClick:()=>h(4),children:[e.jsx(X,{}),e.jsx("span",{children:"Show Less"})]})})]}):e.jsx("h1",{className:"text-3xl font-semibold mb-12 flex items-center justify-center",children:"No reviews Yet"})})]})},xe=({setLoadingBar:c})=>{const[m,r]=o.useState(""),[i,h]=o.useState(""),[f,x]=o.useState(""),[n,g]=o.useState(""),[p,a]=o.useState(""),j=G(),{data:u,isLoading:b,isError:s}=K(j.id),{_id:d,price:y,cutPrice:w,description:I,photos:N,ratings:L,numOfReviews:P,name:k,stock:v,category:T,size:$,color:E}=(u==null?void 0:u.product)||{_id:"",photos:[],category:"",description:"",name:"",stock:0,price:0,ratings:0,numOfReviews:0,cutPrice:0,size:[],color:[]},V=W(),S=$.filter((t,l)=>l%2===1),A=$.filter((t,l)=>l%2===0),R=E.filter((t,l)=>l%2===1),F=E.filter((t,l)=>l%2===0),H=t=>{if(t.stock<1)return C.error("Out of Stock");V(le(t)),C.success("Added to cart")},O=t=>{m!==""&&g(A[t])},Z=t=>{i!==""&&x(F[t])};return o.useEffect(()=>{c(20),c(70)},[j.id]),o.useEffect(()=>{c(100),a(N[0]),window.scroll(0,0),r(S[0]),h(R[0]),g(A[0]),x(F[0])},[u]),s?e.jsx(ee,{to:"/404"}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"",children:[e.jsx("main",{className:"flex flex-col md:flex-row  lsg:w-[70%] px-6 md:px-3 justify-center mt-8",children:b?e.jsx(se,{}):e.jsxs(e.Fragment,{children:[e.jsx("section",{className:"sec1 flex-1 flex-col md:flex-row flex flex-shrink-0 w-full md:w-72 mr-10 mb-10",children:e.jsxs("div",{className:"flex justify-center flex-col gap-3 w-full",children:[e.jsx(ne,{src:`${D}/${p}`,alt:k}),e.jsx("div",{className:"flex gap-2 overflow-auto ",children:N==null?void 0:N.map((t,l)=>e.jsx("img",{src:`${D}/${t}`,height:200,width:200,alt:k,className:`w-20 h-20 rounded-lg object-cover cursor-pointer ${p===t?"border-2 border-black":""}`,onClick:()=>a(t)},l))})]})}),e.jsxs("article",{className:"sec2 flex-1 w-full  md:w-96",children:[e.jsx("p",{className:"min-h-16 text-2xl font-semibold mb-4",children:k}),S.length>1&&e.jsxs("div",{className:"flex mb-4",children:[S.map((t,l)=>e.jsx("button",{className:`${m===t?"bg-black text-white":"bg-white text-gray-800"} border border-black text-gray-800 px-2 py-1 mr-2 rounded-md`,onClick:()=>{r(t),O(l)},children:t},l)),n==="0"&&e.jsx("span",{className:"text-red-500",children:"Not Available"})]}),R.length>1&&e.jsxs("div",{className:"flex mb-4",children:[R.map((t,l)=>e.jsx("button",{className:`${i===t?"ring-4":""} border-gray-500 border rounded-full h-6 w-6 mx-1`,style:{backgroundColor:t},onClick:()=>{h(t),Z(l)}},l)),f==="0"&&e.jsx("span",{className:"text-red-500",children:"Not Available"})]}),e.jsxs("span",{className:"text-lg flex flex-row",children:[e.jsx(_,{rating:L})," Reviews (",P,")"]}),e.jsx("br",{}),e.jsxs("div",{children:["Overall Stock:",`
`,v>0?v<6?e.jsx("span",{className:"text-red-500",children:"Low Stock"}):e.jsx("span",{className:"text-green-500",children:" Available"}):e.jsx("span",{className:"text-red-500",children:"Not Available"})]}),e.jsx("br",{}),e.jsx("h3",{className:"text-lg font-semibold my-2",children:"Description:"}),e.jsx("p",{children:I}),e.jsxs("h3",{className:"text-2xl",children:["$",y,e.jsx("span",{className:"text-lg line-through text-red-500",children:w>0?`$${w}`:""})]}),e.jsx("button",{disabled:v===0||f==="0"||n==="0",className:"cart-button w-full mt-4 px-4 py-2 bg-yellow-500 rounded-md text-white text-lg font-semibold transition duration-300 ease-in-out hover:bg-yellow-600",onClick:()=>H({productId:d,size:m,color:i,price:y,cutPrice:w,name:k,photo:N[0],stock:v,quantity:1}),children:v===0||f==="0"||n==="0"?"Not Available":"Add to Cart"})]})]})}),e.jsx("div",{children:e.jsx(oe,{numOfReviews:P,productId:d})}),e.jsx("div",{className:"flex justify-center items-center",children:e.jsx(te,{filteredProductId:d,category:T,heading:"Related Products"})})]}),e.jsx(re,{})]})},ne=({src:c,alt:m})=>{const[r,i]=o.useState(!1),[h,f]=o.useState("0% 0%"),x=o.useRef(null),n=()=>i(!0),g=()=>i(!1),p=j=>{if(x.current&&r){const{left:u,top:b,width:s,height:d}=x.current.getBoundingClientRect(),y=(j.clientX-u)/s*100,w=(j.clientY-b)/d*100;f(`${y}% ${w}%`)}},a=c.replace(/\\/g,"/");return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative w-full h-[500px] max-md:hidden",onMouseEnter:n,onMouseLeave:g,onMouseMove:p,children:[r&&e.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-no-repeat transition-transform duration-300",style:{backgroundImage:`url(${a})`,backgroundPosition:h,backgroundSize:"200%"}}),e.jsx("img",{ref:x,src:a,alt:m,className:`absolute top-0 left-0 w-full h-full transition-opacity duration-300 ${r?"opacity-0":"opacity-100"}`})]}),e.jsx("img",{src:c,alt:m,className:"w-full shadow-md md:hidden md:h-[500px] h-[300px] object-cover"})]})};export{xe as default};
